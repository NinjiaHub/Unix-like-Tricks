# Crontab服务

crond是linux下用来周期性的执行某种任务或等待处理某些事件的一个守护进程，与windows下的计划任务类似，当安装完成操作系统后，默认会安装此服务工具，并且会自动启动crond进程，crond进程每分钟会定期检查是否有要执行的任务，如果有要执行的任务，则自动执行该任务。

## 相关文件

* /etc/cron.deny 该文件中所列用户不允许使用crontab命令
* /etc/cron.allow 该文件中所列用户允许使用crontab命令
* /var/spool/cron/ 所有用户crontab文件的存放目录，以该用户的用户名命名
* /etc/crontab 系统管理员设置的系统维护任务和其他定时任务
* /etc/cron.d/ 存放任何要执行的crontab文件或脚本

## crontab文件的含义：
用户所建立的crontab文件中，每一行都代表一项任务，每行的每个字段代表一项设置，它的格式共分为六个字段，前五段是时间设定段，第六段是要执行的命令段，格式如下：  

`minute   hour   day   month   week   command`，其中：

* minute： 表示分钟，可以是从0到59之间的任何整数。  
* hour：表示小时，可以是从0到23之间的任何整数。  
* day：表示日期，可以是从1到31之间的任何整数。  
* month：表示月份，可以是从1到12之间的任何整数。  
* week：表示星期几，可以是从0到7之间的任何整数，这里的0或7代表星期日。  
* command：要执行的命令，可以是系统命令，也可以是自己编写的脚本文件。

**注意：配置文件的中的day和week这两个域是或的关系，即只要day和week中的任意一个满足即执行后面的command，而这两个域与其余域之间是与的关系，即需要其余的域满足才会执行command。**

> 在以上各个字段中，还可以使用以下特殊字符：

> * 星号(\*)：代表所有可能的值，例如month字段如果是星号，则表示在满足其它字段的制约条件后每月都执行该命令操作。  
> * 逗号（,）：可以用逗号隔开的值指定一个列表范围，例如，“1,2,5,7,8,9”  
> * 中杠（-）：可以用整数之间的中杠表示一个整数范围，例如“2-6”表示“2,3,4,5,6”  
> * 正斜线（/）：可以用正斜线指定时间的间隔频率，例如“0-23/2”表示每两小时执行一次。同时正斜线可以和星号一起使用，例如*/10，如果用在minute字段，表示每十分钟执行一次。

## 设置定时任务

可以通过下面的方法设置定时任务：

* 在`/var/spool/cron/`目录中的crontab文件不可以直接创建或者直接修改，需要通过`crontab`命令来创建，如：

```shell
$ touch jobs.cron
$ echo '*/15 * * * * echo "jobs"' >> jobs.cron
$ crontab jobs.cron
```

* 在`/etc/cron.d`目录中放置要执行的crontab文件
* root用户直接编辑`/etc/crontab`文件设置定时任务
* 使用`crontab -e`命令来直接设置定时任务，使用`-e`时如果没有指定用户，则会编辑当前用户的crontab文件

## 安装cron

```shell
> yum install vixie-cron
> yum install crontabs
```

## crontab的日志文件

```shell
> /var/log/cron 日志文件的保存位置,可以在该文件中查看crontab的日志
```

## 注意

crontab不是精确定时。

## 声明
如有错误敬请指正。

部分内容参考自网络，如涉及版权问题请联系作者，侵删。

作者邮箱：web.taox@gmail.com